(function(y, J, u) {
	function K(a) {
		a %= g;
		return 0 > a ? a + g : a
	}

	function L(a) {
		var b = q + r * v(a);
		a = m + r * w(a);
		e.B().arc(b, a, h, 0, g, !1).fill();
		e.M(q, m).L(b, a).stroke()
	}

	function D(a, b) {
		var c = q + b * v(a),
			d = m + b * w(a);
		e.B().arc(c, d, h, 0, g, !1).fill()
	}

	function M() {
		if ("over" != d && "pass" != d) {
			var a = z.d || "normal";
			A = (a && N[a] || N.e)(Date.now() - O);
			e.save().fillStyle("#aaa").fillRect(0, 0, s, k).restore();
			e.B().arc(q, m, P, 0, g, !1).fill();
			for (a = 0; a < n.length; a++) L(n[a] + A);
			for (var a = E, b = B; a < k - m + h && 0 < b; a += 30, b--) {
				D(x, a);
				var c = x,
					p = a,
					t = b,
					f = q + p * v(c),
					c = m + p * w(c);
				e.B().arc(f, c, h, 0, g, !1).fill();
				e.save().fillStyle("#fff").fillText(t, f, c, 2 * h).restore()
			}
			if ("shooting" == d) {
				a = x;
				t = E;
				c = r;
				f = c + 2 * h;
				b = (Date.now() - Q) / R;
				1 < b && (b = 1);
				t -= (t - c) * b;
				if (f = t < f) a: {
					for (c = n.length; c--;)
						if (f = K(n[c] - (a - A)), f < F || f > g - F) {
							f = {
								which: c,
								a: f
							};
							break a
						}
					f = !1
				}
				f ? (b = r * w(f.a), b = r * v(f.a) + u.sqrt(4 * h * h - b * b), D(a, b), d = "over", e.save().font("bold 18px sans-serif").textAlign("right").fillStyle("#f00").fillText("\u6302\u4e86\uff01", s - 10, k - 45).fillText("1\u79d2\u540e\u91cd\u65b0\u5f00\u59cb", s - 10, k -
					20).restore(), setTimeout(G, 1E3)) : 1 > b ? D(a, t) : (n.push(K(a - A)), L(a), d = "idle", B || (d = "pass", localStorage.setItem("aaffuu-cxp", '{"aa":' + (l + 1) + "}"), e.save().font("bold 18px sans-serif").textAlign("right").fillStyle("#060").fillText("\u5b8c\u7f8e\u8fc7\u5173\uff01", s - 10, k - 45).fillText("1\u79d2\u540e\u4e0b\u4e00\u5173", s - 10, k - 20).restore(), setTimeout(G, 1E3)))
			}
			e.save().font("bold 18px sans-serif").textAlign("left").fillStyle("#000").fillText("Level: " + l, 10, k - 20).font("bold 48px sans-serif").textAlign("center").fillStyle("#fff").fillText(l,
				q, m).restore();
			U(M)
		}
	}

	function S() {
		d = "shooting";
		Q = Date.now();
		B--
	}

	function T(a) {
		if ("idle" == d) {
			V || ["mousedown", "touchstart", "MSPointerDown", "pointerdown"].forEach(function(b) {
				b != a.type && J.removeEventListener(b, T, !1)
			});
			switch (a.type) {
				case "mousedown":
					if (0 < a.button) return;
					S();
					break;
				case "touchstart":
				case "MSPointerDown":
				case "pointerdown":
					S();
					break;
				default:
					return
			}
			a.preventDefault()
		}
	}

	function G() {
		if (!d || "over" == d || "pass" == d) {
			"pass" == d && l++;
			d = "idle";
			var a;
			a = C.length;
			a = l 